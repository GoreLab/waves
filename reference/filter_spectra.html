<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter spectral data frame based on Mahalanobis distance — filter_spectra • waves</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter spectral data frame based on Mahalanobis distance — filter_spectra"><meta name="description" content="Determine Mahalanobis distances of observations (rows) within a
  given data.frame with spectral data. Option to filter out
  observations based on these distances."><meta property="og:description" content="Determine Mahalanobis distances of observations (rows) within a
  given data.frame with spectral data. Option to filter out
  observations based on these distances."><meta property="og:image" content="https://GoreLab.github.io/waves/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">waves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/waves.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GoreLab/waves/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filter spectral data frame based on Mahalanobis distance</h1>
      <small class="dont-index">Source: <a href="https://github.com/GoreLab/waves/blob/v0.2.6/R/filter_spectra.R" class="external-link"><code>R/filter_spectra.R</code></a></small>
      <div class="d-none name"><code>filter_spectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Determine Mahalanobis distances of observations (rows) within a
  given <code>data.frame</code> with spectral data. Option to filter out
  observations based on these distances.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_spectra</span><span class="op">(</span><span class="va">df</span>, <span class="va">filter</span>, <span class="va">return.distances</span>, <span class="va">num.col.before.spectra</span>,</span>
<span>  <span class="va">window.size</span>, <span class="va">verbose</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p><code>data.frame</code> object containing columns of spectra and rows of
observations. Spectral columns must be labeled with an "X" and then the
wavelength (example: "X740" = 740nm). Left-most column must be unique ID.
May also contain columns of metadata between the unique ID and spectral
columns. Cannot contain any missing values. Metadata column names may not
start with "X".</p></dd>


<dt id="arg-filter">filter<a class="anchor" aria-label="anchor" href="#arg-filter"></a></dt>
<dd><p>boolean that determines whether or not the input
<code>data.frame</code> will be filtered. If <code>TRUE</code>, <code>df</code> will be
filtered according to squared Mahalanobis distance with a 95% cutoff from
a chi-square distribution with degrees of freedom = number of spectral
columns. If <code>FALSE</code>, a column of squared Mahalanobis distances
<code>h.distance</code> will be added to the right side of df and all rows will
be returned. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-return-distances">return.distances<a class="anchor" aria-label="anchor" href="#arg-return-distances"></a></dt>
<dd><p>boolean that determines whether a column of squared
Mahalanobis distances will be included in output <code>data.frame</code>. If
<code>TRUE</code>, a column of Mahalanobis distances for each row will be added
to the right side of <code>df</code>. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-num-col-before-spectra">num.col.before.spectra<a class="anchor" aria-label="anchor" href="#arg-num-col-before-spectra"></a></dt>
<dd><p>number of columns to the left of the spectral
matrix in <code>df</code>. Default is 4.</p></dd>


<dt id="arg-window-size">window.size<a class="anchor" aria-label="anchor" href="#arg-window-size"></a></dt>
<dd><p>number defining the size of window to use when calculating
the covariance of the spectra (required to calculate Mahalanobis distance).
Default is 10.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code>, the number of rows removed through filtering
will be printed to the console. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>filter</code> is <code>TRUE</code>, returns filtered data frame
  <code>df</code> and reports the number of rows removed. The Mahalanobis distance
  with a cutoff of 95% of chi-square distribution (degrees of freedom =
  number of wavelengths) is used as filtering criteria. If <code>filter</code> is
  <code>FALSE</code>, returns full input df with column <code>h.distances</code>
  containing the Mahalanobis distance for each row.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses a chi-square distribution with 95% cutoff where
  degrees of freedom = number of wavelengths (columns) in the input
  <code>data.frame</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Johnson, R.A., and D.W. Wichern. 2007. Applied Multivariate
  Statistical Analysis (6th Edition). pg 189</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jenna Hershberger <a href="mailto:jmh579@cornell.edu">jmh579@cornell.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">filtered.test</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">TCC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">filter_spectra</span><span class="op">(</span></span></span>
<span class="r-in"><span>    df <span class="op">=</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>    filter <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    return.distances <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    num.col.before.spectra <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    window.size <span class="op">=</span> <span class="fl">15</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Removed 0 rows.</span>
<span class="r-in"><span><span class="va">filtered.test</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">filtered.test</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">filtered.test</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   study.name sample.id DMC.oven      X350      X351    X2495    X2496    X2497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    C16Mcal C16Mcal_1 39.62109 0.4881079 0.4951843 1.867221 1.868554 1.866739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    C16Mcal C16Mcal_2 35.52017 0.5727389 0.5682541 1.886785 1.891462 1.893840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    C16Mcal C16Mcal_3 42.04462 0.5989934 0.6266454 1.838917 1.832336 1.834644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    C16Mcal C16Mcal_4 39.00999 0.5169374 0.5164186 1.841245 1.839129 1.837023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    C16Mcal C16Mcal_5 33.44273 0.5189608 0.5477946 1.891752 1.899751 1.900873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      X2498    X2499    X2500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.867465 1.870405 1.870702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.901451 1.891114 1.888507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.828793 1.826562 1.832022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.836635 1.835856 1.834857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.897076 1.899430 1.896130</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jmh579.github.io" class="external-link">Jenna Hershberger</a>, NSF BREAD IOS-1543958.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

