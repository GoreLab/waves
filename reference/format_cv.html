<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Format multiple trials with or without overlapping genotypes into training and test sets according to user-provided cross validation scheme — format_cv • waves</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Format multiple trials with or without overlapping genotypes into training and test sets according to user-provided cross validation scheme — format_cv"><meta name="description" content="Standalone function that is also used within
  train_spectra to divide trials or studies into training and
  test sets based on overlap in trial environments and genotype entries"><meta property="og:description" content="Standalone function that is also used within
  train_spectra to divide trials or studies into training and
  test sets based on overlap in trial environments and genotype entries"><meta property="og:image" content="https://GoreLab.github.io/waves/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">waves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/waves.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GoreLab/waves/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Format multiple trials with or without overlapping genotypes into training and test sets according to user-provided cross validation scheme</h1>
      <small class="dont-index">Source: <a href="https://github.com/GoreLab/waves/blob/main/R/format_cv.R" class="external-link"><code>R/format_cv.R</code></a></small>
      <div class="d-none name"><code>format_cv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Standalone function that is also used within
  <code><a href="train_spectra.html">train_spectra</a></code> to divide trials or studies into training and
  test sets based on overlap in trial environments and genotype entries</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">format_cv</span><span class="op">(</span></span>
<span>  <span class="va">trial1</span>,</span>
<span>  <span class="va">trial2</span>,</span>
<span>  trial3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">cv.scheme</span>,</span>
<span>  stratified.sampling <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  proportion.train <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  remove.genotype <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-trial-">trial1<a class="anchor" aria-label="anchor" href="#arg-trial-"></a></dt>
<dd><p><code>data.frame</code> object that is for use only when
<code>cv.scheme</code> is provided. Contains the trial to be tested in subsequent
model training functions. The first column contains unique identifiers,
second contains genotypes, third contains reference values, followed by
spectral columns. Include no other columns to right of spectra! Column
names of spectra must start with "X", reference column must be named
"reference", and genotype column must be named "genotype".</p></dd>


<dt id="arg-trial-">trial2<a class="anchor" aria-label="anchor" href="#arg-trial-"></a></dt>
<dd><p><code>data.frame</code> object that is for use only when
<code>cv.scheme</code> is provided. This data.frame contains a trial that has
overlapping genotypes with <code>trial1</code> but that were grown in a different
site/year (different environment). Formatting must be consistent with
<code>trial1</code>.</p></dd>


<dt id="arg-trial-">trial3<a class="anchor" aria-label="anchor" href="#arg-trial-"></a></dt>
<dd><p><code>data.frame</code> object that is for use only when
<code>cv.scheme</code> is provided. This data.frame contains a trial that may or
may not contain genotypes that overlap with <code>trial1</code>. Formatting must
be consistent with <code>trial1</code>.</p></dd>


<dt id="arg-cv-scheme">cv.scheme<a class="anchor" aria-label="anchor" href="#arg-cv-scheme"></a></dt>
<dd><p>A cross validation (CV) scheme from Jarquín et al., 2017.
Options for <code>cv.scheme</code> include:</p><ul><li><p>"CV1": untested lines in tested environments</p></li>
<li><p>"CV2": tested lines in tested environments</p></li>
<li><p>"CV0": tested lines in untested environments</p></li>
<li><p>"CV00": untested lines in untested environments</p></li>
</ul></dd>


<dt id="arg-stratified-sampling">stratified.sampling<a class="anchor" aria-label="anchor" href="#arg-stratified-sampling"></a></dt>
<dd><p>If <code>TRUE</code>, training and test
sets will be selected using stratified random sampling. Default is
<code>TRUE</code>.</p></dd>


<dt id="arg-proportion-train">proportion.train<a class="anchor" aria-label="anchor" href="#arg-proportion-train"></a></dt>
<dd><p>Fraction of samples to include in the training set.
Default is 0.7.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Number used in the function <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> for reproducible
randomization. If <code>NULL</code>, no seed is set. Default is <code>NULL</code>.</p></dd>


<dt id="arg-remove-genotype">remove.genotype<a class="anchor" aria-label="anchor" href="#arg-remove-genotype"></a></dt>
<dd><p>boolean that, if <code>TRUE</code>, removes the "genotype"
column is removed from the output <code>data.frame</code>. Default is
<code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of data.frames ($train.set, $test.set) compiled according to
  user-provided cross validation scheme.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Use of a cross-validation scheme requires a column in the input
  <code>data.frame</code> named "genotype" to ensure proper sorting of training and
  test sets. Variables <code>trial1</code> and <code>trial2</code> are required, while
  <code>trial 3</code> is optional.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jarquín, D., C. Lemes da Silva, R. C. Gaynor, J. Poland, A.
  Fritz, R. Howard, S. Battenfield, and J. Crossa. 2017. Increasing
  genomic-enabled prediction accuracy by modeling genotype × environment
  interactions in Kansas wheat. Plant Genome 10(2):1-15.
  &lt;doi:10.3835/plantgenome2016.12.0130&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jenna Hershberger <a href="mailto:jmh579@cornell.edu">jmh579@cornell.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Must have a column called "genotype", so we'll create a fake one for now</span></span></span>
<span class="r-in"><span><span class="co"># We will use CV00, which does not require any overlap in genotypes</span></span></span>
<span class="r-in"><span><span class="co"># In real scenarios, CV schemes that rely on genotypes should not be applied</span></span></span>
<span class="r-in"><span><span class="co"># when genotypes are unknown, as in this case.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trials</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>genotype <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ikeogu.2017</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># fake for this example</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>reference <span class="op">=</span> <span class="va">DMC.oven</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">study.name</span>, <span class="va">sample.id</span>, <span class="va">genotype</span>, <span class="va">reference</span>,</span></span>
<span class="r-in"><span>    <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial1</span> <span class="op">&lt;-</span> <span class="va">trials</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study.name</span> <span class="op">==</span> <span class="st">"C16Mcal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">study.name</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial2</span> <span class="op">&lt;-</span> <span class="va">trials</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study.name</span> <span class="op">==</span> <span class="st">"C16Mval"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">study.name</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cv.list</span> <span class="op">&lt;-</span> <span class="fu">format_cv</span><span class="op">(</span></span></span>
<span class="r-in"><span>  trial1 <span class="op">=</span> <span class="va">trial1</span>, trial2 <span class="op">=</span> <span class="va">trial2</span>, cv.scheme <span class="op">=</span> <span class="st">"CV00"</span>,</span></span>
<span class="r-in"><span>  stratified.sampling <span class="op">=</span> <span class="cn">FALSE</span>, remove.genotype <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cv.list</span><span class="op">$</span><span class="va">train.set</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample.id reference  X350  X351  X352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> C16Mval_1      44.1 0.497 0.474 0.489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> C16Mval_2      43.7 0.546 0.556 0.557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> C16Mval_3      43.4 0.513 0.521 0.529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> C16Mval_4      43.1 0.565 0.570 0.583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> C16Mval_5      41.8 0.497 0.502 0.510</span>
<span class="r-in"><span><span class="va">cv.list</span><span class="op">$</span><span class="va">test.set</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample.id  reference  X350  X351  X352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> C16Mcal_11      35.2 0.520 0.518 0.522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> C16Mcal_13      35.4 0.491 0.496 0.497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> C16Mcal_15      31.6 0.652 0.649 0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> C16Mcal_16      36.4 0.517 0.514 0.530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> C16Mcal_18      39.6 0.536 0.505 0.504</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jmh579.github.io" class="external-link">Jenna Hershberger</a>, NSF BREAD IOS-1543958.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

