<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>waves • waves</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="waves">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">waves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/waves.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GoreLab/waves/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>waves</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/GoreLab/waves/blob/v0.2.6/vignettes/waves.Rmd" class="external-link"><code>vignettes/waves.Rmd</code></a></small>
      <div class="d-none name"><code>waves.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://GoreLab.github.io/waves/">waves</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Originally designed application in the context of resource-limited
plant research and breeding programs, <code>waves</code> provides an
open-source solution to spectral data processing and model development
by bringing useful packages together into a streamlined pipeline. This
package is wrapper for functions related to the analysis of point
visible and near-infrared reflectance measurements. It includes
visualization, filtering, aggregation, pretreatment, cross-validation
set formation, model training, and prediction functions to enable
open-source association of spectral and reference data.</p>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p>Follow the installation instructions below, and then go wild! Use
<code>waves</code> to analyze your own data. Please report any bugs or
feature requests by opening issues in the <a href="https://github.com/GoreLab/waves" class="external-link"><code>waves</code>
repository</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the latest <code>waves</code> release directly from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"waves"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://GoreLab.github.io/waves/">waves</a></span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, install the development version to get the most
up-to-date (but not necessarily thoroughly tested) version:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"GoreLab/waves"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://GoreLab.github.io/waves/">waves</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="format-your-data">1. Format your data<a class="anchor" aria-label="anchor" href="#format-your-data"></a>
</h2>
<p>Match spectra with reference values so that you have a
<code>data.frame</code> with unique identifiers, reference values, and
other metadata as columns to the left of spectral values. Spectral
column names should start with “X”. Remove rows with missing values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ikeogu.2017</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 7</span></span></span>
<span><span class="co">#&gt;   study.name sample.id DMC.oven   TCC  X350  X351  X352</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> C16Mcal    C16Mcal_1     39.6  1.00 0.488 0.495 0.506</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C16Mcal    C16Mcal_2     35.5 17.0  0.573 0.568 0.599</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C16Mcal    C16Mcal_3     42.0 21.6  0.599 0.627 0.624</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> C16Mcal    C16Mcal_4     39.0  2.43 0.517 0.516 0.514</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> C16Mcal    C16Mcal_5     33.4 24.0  0.519 0.548 0.554</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> C16Mcal    C16Mcal_6     32.1 19.0  0.576 0.566 0.589</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> C16Mcal    C16Mcal_7     35.8  6.61 0.530 0.536 0.525</span></span>
<span></span>
<span><span class="va">ikeogu.2017.prepped</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>unique.id <span class="op">=</span> <span class="va">sample.id</span>,</span>
<span>                reference <span class="op">=</span> <span class="va">DMC.oven</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">unique.id</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">TCC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ikeogu.2017.prepped</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 7</span></span></span>
<span><span class="co">#&gt;   unique.id study.name reference  X350  X351  X352  X353</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> C16Mcal_1 C16Mcal         39.6 0.488 0.495 0.506 0.494</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C16Mcal_2 C16Mcal         35.5 0.573 0.568 0.599 0.593</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C16Mcal_3 C16Mcal         42.0 0.599 0.627 0.624 0.606</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> C16Mcal_4 C16Mcal         39.0 0.517 0.516 0.514 0.536</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> C16Mcal_5 C16Mcal         33.4 0.519 0.548 0.554 0.549</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> C16Mcal_6 C16Mcal         32.1 0.576 0.566 0.589 0.591</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> C16Mcal_7 C16Mcal         35.8 0.530 0.536 0.525 0.539</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-spectra-with-plot_spectra">2. Visualize spectra with <code>plot_spectra()</code><a class="anchor" aria-label="anchor" href="#visualize-spectra-with-plot_spectra"></a>
</h2>
<p>To display outliers in a different color, set
<code>detect.outliers</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ikeogu.2017.prepped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_spectra.html">plot_spectra</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">.</span>,</span>
<span>    num.col.before.spectra <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    detect.outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    alternate.title <span class="op">=</span> <span class="st">"Example spectra"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="waves_files/figure-html/plot_raw-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="perform-outlier-removal-with-filter_spectra-">3. Perform outlier removal with <code>filter_spectra()</code>.<a class="anchor" aria-label="anchor" href="#perform-outlier-removal-with-filter_spectra-"></a>
</h2>
<p><code>waves</code> uses Mahalanobis distance to identify outliers.
Mahalanobis distance is a common metric used to identify multivariate
outliers. The larger the value of Mahalanobis distance, the more unusual
the data point (i.e., the more likely it is to be a multivariate
outlier).</p>
<p>The distance tells us how far an observation is from the center of
the cloud, taking into account the shape (covariance) of the cloud as
well.</p>
<p>To detect outliers, the calculated Mahalanobis distance is compared
against a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distribution with degrees of freedom equal to the number of spectral
data columns and an alpha level of 0.05.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered.df</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017.prepped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/filter_spectra.html">filter_spectra</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">.</span>,</span>
<span>    filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    return.distances <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    num.col.before.spectra <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    window.size <span class="op">=</span> <span class="fl">15</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Removed 0 rows.</span></span>
<span></span>
<span><span class="va">filtered.df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">filtered.df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">filtered.df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;   unique.id study.name reference      X350      X351    X2497    X2498    X2499</span></span>
<span><span class="co">#&gt; 1 C16Mcal_1    C16Mcal  39.62109 0.4881079 0.4951843 1.866739 1.867465 1.870405</span></span>
<span><span class="co">#&gt; 2 C16Mcal_2    C16Mcal  35.52017 0.5727389 0.5682541 1.893840 1.901451 1.891114</span></span>
<span><span class="co">#&gt; 3 C16Mcal_3    C16Mcal  42.04462 0.5989934 0.6266454 1.834644 1.828793 1.826562</span></span>
<span><span class="co">#&gt; 4 C16Mcal_4    C16Mcal  39.00999 0.5169374 0.5164186 1.837023 1.836635 1.835856</span></span>
<span><span class="co">#&gt; 5 C16Mcal_5    C16Mcal  33.44273 0.5189608 0.5477946 1.900873 1.897076 1.899430</span></span>
<span><span class="co">#&gt;      X2500</span></span>
<span><span class="co">#&gt; 1 1.870702</span></span>
<span><span class="co">#&gt; 2 1.888507</span></span>
<span><span class="co">#&gt; 3 1.832022</span></span>
<span><span class="co">#&gt; 4 1.834857</span></span>
<span><span class="co">#&gt; 5 1.896130</span></span></code></pre></div>
<p>No outliers were identified in the example dataset. Note the if
<code>return.distances</code> is set to <code>TRUE</code>, the rightmost
column contains Mahalanobis distances (<code>h.distances</code>).</p>
</div>
<div class="section level2">
<h2 id="aggregate-scans">4. Aggregate scans<a class="anchor" aria-label="anchor" href="#aggregate-scans"></a>
</h2>
<p>If you have more than one scan per unique identifier, aggregate the
scans by mean or median with <code><a href="../reference/aggregate_spectra.html">aggregate_spectra()</a></code>.</p>
<p>In this example, we will aggregate by <code>study.name</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggregated.test</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017.prepped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/aggregate_spectra.html">aggregate_spectra</a></span><span class="op">(</span></span>
<span>    grouping.colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study.name"</span><span class="op">)</span>,</span>
<span>    reference.value.colname <span class="op">=</span> <span class="st">"reference"</span>,</span>
<span>    agg.function <span class="op">=</span> <span class="st">"mean"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">aggregated.test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   study.name reference  X350  X351  X352</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> C16Mcal         36.1 0.559 0.562 0.569</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C16Mval         36.4 0.545 0.549 0.552</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluate-the-predictive-ability-of-your-spectra">5. Evaluate the predictive ability of your spectra<a class="anchor" aria-label="anchor" href="#evaluate-the-predictive-ability-of-your-spectra"></a>
</h2>
<p><code><a href="../reference/test_spectra.html">test_spectra()</a></code> is a wrapper that performs spectral
pretreatment (<a href="#id_5.1.%20Pretreat%20spectra">5.1</a>),
cross-validation set formation (<a href="#id_5.2.%20Specify%20a%20cross-validation%20scheme">5.2</a>), and
model training functions over multiple iterations (<a href="#id_5.3.%20Train%20spectral%20prediction%20models">5.3</a>).</p>
<p>Note that the following subsections describe functions that are
called within <code><a href="../reference/test_spectra.html">test_spectra()</a></code>. They do not need to be used
separately for model pretreatment, cross-validation set formation, or
model training.</p>
<p>Some of the arguments for this function are detailed below. A
description of output is below under section <a href="#id_5.4.%20Output">5.4</a>. See <code>?test_spectra()</code> for
more information on the arguments and output for this function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.list</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017.prepped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">unique.id</span>, <span class="va">reference</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/test_spectra.html">test_spectra</a></span><span class="op">(</span></span>
<span>    train.data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    tune.length <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    num.iterations <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    pretreatment <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `save.model` argument of `test_spectra()` is deprecated as of waves 0.2.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Models are now saved by default.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">waves</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/GoreLab/waves/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: The `return.model` argument of `test_spectra()` is deprecated as of waves</span></span>
<span><span class="co">#&gt; 0.2.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Trained models are now returned by default.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">waves</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/GoreLab/waves/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Pretreatment initiated.</span></span>
<span><span class="co">#&gt; Training models...</span></span>
<span><span class="co">#&gt; Working on Raw_data</span></span>
<span><span class="co">#&gt; Warning: The `wavelengths` argument of `train_spectra()` is deprecated as of waves</span></span>
<span><span class="co">#&gt; 0.2.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Wavelength specification is now inferred from column names.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">waves</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/GoreLab/waves/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: The `preprocessing` argument of `train_spectra()` is deprecated as of waves</span></span>
<span><span class="co">#&gt; 0.2.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Argument `preprocessing` is deprecated. Use `pretreatment` instead:</span></span>
<span><span class="co">#&gt;   `pretreatment = 1:13` (all), or `pretreatment = 1` (raw only).</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">waves</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/GoreLab/waves/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: The `save.model` argument of `train_spectra()` is deprecated as of waves 0.2.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Models are now saved by default.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">waves</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/GoreLab/waves/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pls'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     R2</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span>
<span><span class="co">#&gt; Returning model...</span></span></code></pre></div>
<div class="section level3">
<h3 id="pretreat-spectra">5.1. Pretreat spectra<a class="anchor" aria-label="anchor" href="#pretreat-spectra"></a>
</h3>
<p>Specify which spectral pretreatments (1-13) to apply with the
parameter <code>pretreatment</code>. <code><a href="../reference/pretreat_spectra.html">pretreat_spectra()</a></code> can
also be used on its own to transform a data.frame using any/all of 12
available pretreatments:</p>
<ol style="list-style-type: decimal">
<li>Raw data (no pretreatment is applied)</li>
<li>Standard normal variate (SNV)</li>
<li>SNV and first derivative</li>
<li>SNV and second derivative</li>
<li>First derivative</li>
<li>Second derivative</li>
<li>Savitzky–Golay filter (SG)</li>
<li>SNV and SG</li>
<li>Gap segment derivative (window size = 11)</li>
<li>SG and first derivative (window size = 5)</li>
<li>SG and first derivative (window size = 11)</li>
<li>SG and second derivative (window size = 5)</li>
<li>SG and second derivative (window size = 11)</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ikeogu.2017.prepped</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># subset the first 10 scans for speed</span></span>
<span>  <span class="fu"><a href="../reference/pretreat_spectra.html">pretreat_spectra</a></span><span class="op">(</span>pretreatment <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># exclude pretreatment 1 (raw data)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"pretreatment"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"wl"</span>,</span>
<span>         value <span class="op">=</span> <span class="st">"s.value"</span>,</span>
<span>         <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>wl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html" class="external-link">parse_number</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">wl</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         pretreatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">pretreatment</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">s.value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wl</span>, y <span class="op">=</span> <span class="va">s.value</span>, group <span class="op">=</span> <span class="va">unique.id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pretreated spectra"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Wavelength"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Spectral Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">pretreatment</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="waves_files/figure-html/plot_pretreatments-1.png" width="672" style="display: block; margin: auto;">
Note that the scales in this plot are “free”. Without free scales,
anything derivative-based treatment (D1 or D2) looks like it’s a
constant zero in comparison to those without derivative-based treatments
(SNV, SG).</p>
</div>
<div class="section level3">
<h3 id="specify-a-cross-validation-scheme">5.2. Specify a cross-validation scheme<a class="anchor" aria-label="anchor" href="#specify-a-cross-validation-scheme"></a>
</h3>
<p>Choose from random, stratified random, or a plant breeding-specific
scheme from <a href="https://doi.org/10.3835/plantgenome2016.12.0130" class="external-link">Jarquín et
<em>al.</em>, 2017. <em>The Plant Genome</em></a>. Options include:</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th><code>cv.scheme</code></th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>NULL</code></td>
<td>Random or stratified random sampling (does not take genotype or
environment into account)</td>
</tr>
<tr class="even">
<td>“CV1”</td>
<td>Untested lines in tested environments</td>
</tr>
<tr class="odd">
<td>“CV2”</td>
<td>Tested lines in tested environments</td>
</tr>
<tr class="even">
<td>“CV0”</td>
<td>Tested lines in untested environments</td>
</tr>
<tr class="odd">
<td>“CV00”</td>
<td>Untested lines in untested environments</td>
</tr>
</tbody>
</table>
<p>If <code>cv.scheme</code> is set to <code>NULL</code>, the argument
<code>stratified.sampling</code> is used to determine whether stratified
random sampling should be performed. If <code>TRUE</code>, the reference
values from the input <code>data.frame</code> (<code>train.data</code>)
will be used to create a balanced split of data between the training and
test sets in each training iteration.</p>
<p>When using one of the four specialized cross-validation schemes
(“CV1”, “CV2”, “CV0”, or “CV00”), additional arguments are required: -
<code>trial1</code> contains the trial to be tested in subsequent model
training functions. The first column contains unique identifiers, second
contains genotypes, third contains reference values, followed by
spectral columns. Include no other columns to right of spectra! Column
names of spectra must start with “X”, reference column must be named
“reference”, and genotype column must be named “genotype”.
-<code>trial2</code> contains a trial that has overlapping genotypes
with <code>trial1</code> but that were grown in a different site/year
(different environment). Formatting must be consistent with
<code>trial1</code>. - <code>trial3</code> contains a trial that may or
may not contain genotypes that overlap with <code>trial1</code>.
Formatting must be consistent with <code>trial1</code>.</p>
<p>Cross-validation schemes can also be formatted outside of
<code><a href="../reference/test_spectra.html">test_spectra()</a></code> using the function
<code><a href="../reference/format_cv.html">format_cv()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="train-spectral-prediction-models">5.3. Train spectral prediction models<a class="anchor" aria-label="anchor" href="#train-spectral-prediction-models"></a>
</h3>
<p>Many of the arguments for <code><a href="../reference/test_spectra.html">test_spectra()</a></code> are related to
model training: - <code>model.method</code> is the algorithm type to use
for training. See the table below for more information -
<code>tune.length</code> is the number of PLS components to test. This
argument is ignored if other algorithms are used -
<code>best.model.metric</code> indicates the metric used to decide which
model is best (“RMSE” or “R-squared”) - <code>k-fold</code> specifies
the number of folds used for cross-validation to tune model
hyperparameters within the training set - <code>num.iterations</code>
sets the number of training iterations - <code>proportion.train</code>
is the fraction of samples to be included in the training set (default
is 0.7)</p>
<p>Models can also be trained with the standalone function
<code><a href="../reference/train_spectra.html">train_spectra()</a></code>. Model training is implemented with <a href="https://topepo.github.io/caret/" class="external-link"><code>caret</code></a>.</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="9%">
<col width="39%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th>Algorithm</th>
<th><code>model.method</code></th>
<th>R package source</th>
<th>Tuning parameters (hyperparameters)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Partial least squares (PLS)</td>
<td>“pls”</td>
<td><a href="https://CRAN.R-project.org/package=pls" class="external-link"><code>pls</code></a></td>
<td>ncomp</td>
</tr>
<tr class="even">
<td>Random forest (RF)</td>
<td>“rf”</td>
<td><a href="https://CRAN.R-project.org/package=randomForest" class="external-link"><code>randomForest</code></a></td>
<td>mtry</td>
</tr>
<tr class="odd">
<td>Support vector machine (SVM) with linear kernel</td>
<td>“svmLinear”</td>
<td><a href="https://CRAN.R-project.org/package=kernlab" class="external-link"><code>kernlab</code></a></td>
<td>C</td>
</tr>
<tr class="even">
<td>Support vector machine (SVM) with radial kernel</td>
<td>“svmRadial</td>
<td><a href="https://CRAN.R-project.org/package=kernlab" class="external-link"><code>kernlab</code></a></td>
<td>sigma, C</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output">5.4. Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p><code><a href="../reference/test_spectra.html">test_spectra()</a></code> outputs a list with four objects:</p>
<ol style="list-style-type: decimal">
<li>
<code>model.list</code> is a list of trained model objects, one for
each pretreatment method specified by the <code>pretreatment</code>
argument. Each model is trained with all rows of the input
<code>data.frame</code> (<code>df</code>)</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results.list</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data:    X dimension: 173 2151 </span></span>
<span><span class="co">#&gt;  Y dimension: 173 1</span></span>
<span><span class="co">#&gt; Fit method: kernelpls</span></span>
<span><span class="co">#&gt; Number of components considered: 3</span></span>
<span><span class="co">#&gt; TRAINING: % variance explained</span></span>
<span><span class="co">#&gt;            1 comps  2 comps  3 comps</span></span>
<span><span class="co">#&gt; X            62.65    68.38    91.17</span></span>
<span><span class="co">#&gt; reference    63.34    75.71    76.87</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<code>summary.model.performance</code> is a <code>data.frame</code>
containing summary statistics across all model training iterations and
pretreatments. See below for a description of the summary statistics
provided.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.list</span><span class="op">$</span><span class="va">summary.model.performance</span></span>
<span><span class="co">#&gt;   SummaryType ModelType      RMSEp        R2p       RPD      RPIQ        CCC</span></span>
<span><span class="co">#&gt; 1        mean       pls 1.95376055 0.81071964 2.2929289 2.7735699 0.89625825</span></span>
<span><span class="co">#&gt; 2          sd       pls 0.09988373 0.02828736 0.1234882 0.1134962 0.01896225</span></span>
<span><span class="co">#&gt; 3        mode       pls 1.85463762 0.83763116 2.3948734 2.8890861 0.91442160</span></span>
<span><span class="co">#&gt;          Bias       SEP     RMSEcv        R2cv       R2sp best.ncomp best.ntree</span></span>
<span><span class="co">#&gt; 1 -0.03665762 1.9740073 2.00724284 0.751925760 0.76195677          3         NA</span></span>
<span><span class="co">#&gt; 2  0.15395985 0.1009188 0.02247514 0.008214219 0.02488035          0         NA</span></span>
<span><span class="co">#&gt; 3 -0.07584944 1.8738572 2.01782789 0.750662996 0.77188776          3         NA</span></span>
<span><span class="co">#&gt;   best.mtry</span></span>
<span><span class="co">#&gt; 1        NA</span></span>
<span><span class="co">#&gt; 2        NA</span></span>
<span><span class="co">#&gt; 3        NA</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>
<code>model.performance</code> is a <code>data.frame</code>
containing performance statistics for each iteration of model training
separately (see below).</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.list</span><span class="op">$</span><span class="va">model.performance</span></span>
<span><span class="co">#&gt;   Iteration ModelType    RMSEp       R2p      RPD     RPIQ       CCC</span></span>
<span><span class="co">#&gt; 1         1       pls 1.854638 0.8376312 2.394873 2.889086 0.9144216</span></span>
<span><span class="co">#&gt; 2         2       pls 2.054388 0.7812326 2.155615 2.662208 0.8765871</span></span>
<span><span class="co">#&gt; 3         3       pls 1.952256 0.8132952 2.328298 2.769416 0.8977660</span></span>
<span><span class="co">#&gt;          Bias      SEP   RMSEcv      R2cv      R2sp best.ncomp best.ntree</span></span>
<span><span class="co">#&gt; 1 -0.07584944 1.873857 2.017828 0.7506630 0.7718878          3         NA</span></span>
<span><span class="co">#&gt; 2  0.13311031 2.075678 1.981430 0.7606982 0.7803379          3         NA</span></span>
<span><span class="co">#&gt; 3 -0.16723372 1.972487 2.022471 0.7444160 0.7336447          3         NA</span></span>
<span><span class="co">#&gt;   best.mtry</span></span>
<span><span class="co">#&gt; 1        NA</span></span>
<span><span class="co">#&gt; 2        NA</span></span>
<span><span class="co">#&gt; 3        NA</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>
<code>predictions</code> is a <code>data.frame</code> containing
both reference and predicted values for each test set entry in each
iteration of model training.</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results.list</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Iteration ModelType  unique.id reference predicted</span></span>
<span><span class="co">#&gt; 1         1       pls  C16Mcal_5  33.44273  29.65800</span></span>
<span><span class="co">#&gt; 2         1       pls C16Mcal_17  36.62819  38.96732</span></span>
<span><span class="co">#&gt; 3         1       pls C16Mcal_18  39.56322  36.66932</span></span>
<span><span class="co">#&gt; 4         1       pls C16Mcal_28  29.21000  30.11402</span></span>
<span><span class="co">#&gt; 5         1       pls C16Mcal_31  32.40875  33.56930</span></span>
<span><span class="co">#&gt; 6         1       pls C16Mcal_37  36.74377  37.08231</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>
<code>importance</code> is a <code>data.frame</code> containing
variable importance results for each wavelength at each iteration of
model training. If <code>model.method</code> is not “pls” or “rf”, this
list item is <code>NULL</code>.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.list</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 7</span></span></span>
<span><span class="co">#&gt;   Iteration ModelType   X350   X351   X352   X353   X354</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 pls       0.040<span style="text-decoration: underline;">4</span> 0.039<span style="text-decoration: underline;">7</span> 0.037<span style="text-decoration: underline;">4</span> 0.036<span style="text-decoration: underline;">9</span> 0.038<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         2 pls       0.027<span style="text-decoration: underline;">7</span> 0.026<span style="text-decoration: underline;">3</span> 0.027<span style="text-decoration: underline;">9</span> 0.027<span style="text-decoration: underline;">8</span> 0.028<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         3 pls       0.022<span style="text-decoration: underline;">3</span> 0.022<span style="text-decoration: underline;">5</span> 0.023<span style="text-decoration: underline;">8</span> 0.024<span style="text-decoration: underline;">2</span> 0.025<span style="text-decoration: underline;">4</span></span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="25%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Statistic*</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>RMSE<sub>p</sub>
</td>
<td>Root mean squared error of prediction</td>
</tr>
<tr class="even">
<td>R<sup>2</sup><sub>p</sub>
</td>
<td>Squared Pearson’s correlation between predicted and observed test
set values</td>
</tr>
<tr class="odd">
<td>RPD</td>
<td>Ratio of standard deviation of observed test set values to
RMSE<sub>p</sub>
</td>
</tr>
<tr class="even">
<td>RPIQ</td>
<td>Ratio of performance to interquartile difference</td>
</tr>
<tr class="odd">
<td>CCC</td>
<td>Concordance correlation coefficient</td>
</tr>
<tr class="even">
<td>Bias</td>
<td>Average difference between the predicted and observed values</td>
</tr>
<tr class="odd">
<td>SEP</td>
<td>Standard error of prediction</td>
</tr>
<tr class="even">
<td>RMSE<sub>cv</sub>
</td>
<td>Root mean squared error of cross-validation</td>
</tr>
<tr class="odd">
<td>R<sup>2</sup><sub>cv</sub>
</td>
<td>Coefficient of multiple determination of cross-validation for PLS
models</td>
</tr>
<tr class="even">
<td>R<sup>2</sup><sub>sp</sub>
</td>
<td>Squared Spearman’s rank correlation between predicted and observed
test set values</td>
</tr>
<tr class="odd">
<td>best.ncomp</td>
<td>Best number of components in a PLS model</td>
</tr>
<tr class="even">
<td>best.ntree</td>
<td>Best number of trees in an RF model</td>
</tr>
<tr class="odd">
<td>best.mtry</td>
<td>Best number of variables to include at every decision point in an RF
model</td>
</tr>
</tbody>
</table>
<p>*Many of the spectral model performance statistics are calculated
using the function <code>postResampleSpectro()</code> from the
<code>spectacles</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="save-trained-prediction-models-with-save_model">6. Save trained prediction models with
<code>save_model()</code><a class="anchor" aria-label="anchor" href="#save-trained-prediction-models-with-save_model"></a>
</h2>
<ul>
<li>Intended for a production environment</li>
<li>Can evaluate spectral pretreatment methods using the input
dataset</li>
<li>Selects best model using the metric provided with
<code>best.model.metric</code> (“RMSE” or “Rsquared”)</li>
<li>Returns trained model with option to save as .Rds object</li>
<li>The <code>$model</code> output from <code><a href="../reference/test_spectra.html">test_spectra()</a></code> can
also be saved and used for prediction, but <code><a href="../reference/save_model.html">save_model()</a></code>
will take the extra step of saving an .Rds file for you if
<code>write.model</code> is set to <code>TRUE</code>.</li>
</ul>
<p>In the example below, we’ll use one subset of the example dataset
(“C16Mcal”) to create the model and then we’ll predict the other subset
(“C16Mval”) in section <a href="#id_7.%20Predict%20phenotypic%20values%20with%20new%20spectra">7</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.to.save</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017.prepped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study.name</span> <span class="op">==</span> <span class="st">"C16Mcal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">unique.id</span>, <span class="va">reference</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/save_model.html">save_model</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">.</span>,</span>
<span>    write.model <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    pretreatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span>,  <span class="co"># Raw, SNV, and SNVSG (typically best performers)</span></span>
<span>    tune.length <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    num.iterations <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>Now let’s take a look at our trained model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model.to.save</span><span class="op">$</span><span class="va">best.model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data:    X dimension: 120 2141 </span></span>
<span><span class="co">#&gt;  Y dimension: 120 1</span></span>
<span><span class="co">#&gt; Fit method: kernelpls</span></span>
<span><span class="co">#&gt; Number of components considered: 3</span></span>
<span><span class="co">#&gt; TRAINING: % variance explained</span></span>
<span><span class="co">#&gt;            1 comps  2 comps  3 comps</span></span>
<span><span class="co">#&gt; X            64.48    87.94    91.43</span></span>
<span><span class="co">#&gt; reference    33.93    64.97    87.18</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.to.save</span><span class="op">$</span><span class="va">best.model.stats</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"statistic"</span>, value <span class="op">=</span> <span class="st">"value"</span>, <span class="va">RMSEp_mean</span><span class="op">:</span><span class="va">best.mtry_mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">statistic</span>, into <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"statistic"</span>, <span class="st">"summary_type"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Pretreatment</span>, <span class="va">summary_type</span><span class="op">)</span>,</span>
<span>              names_from <span class="op">=</span> <span class="va">statistic</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 15</span></span></span>
<span><span class="co">#&gt;   Pretreatment summary_type RMSEp    R2p   RPD  RPIQ    CCC   Bias   SEP RMSEcv</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> SNVSG        mean         1.72  0.860  2.74  3.33  0.915   0.142 1.74  1.54  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> SNVSG        sd           0.202 0.065<span style="text-decoration: underline;">0</span> 0.718 0.182 0.046<span style="text-decoration: underline;">6</span>  0.563 0.205 0.030<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> SNVSG        mode         1.58  0.906  3.25  3.46  0.948  -<span style="color: #BB0000;">0.256</span> 1.60  1.56  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: R2cv &lt;dbl&gt;, R2sp &lt;dbl&gt;, best.ncomp &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   best.ntree &lt;dbl&gt;, best.mtry &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predict-phenotypic-values-with-new-spectra">7. Predict phenotypic values with new spectra<a class="anchor" aria-label="anchor" href="#predict-phenotypic-values-with-new-spectra"></a>
</h2>
<p>If generating predictions from a saved model file in .Rds format, use
<code><a href="../reference/predict_spectra.html">predict_spectra()</a></code>. If the model object is already in your R
environment, the function <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">stats::predict()</a></code> can be used to
generate predictions. <code><a href="../reference/predict_spectra.html">predict_spectra()</a></code> pulls the best
model hyperparameters from your saved model object, but if using
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">stats::predict()</a></code>, these must be supplied separately.</p>
<p>Using the model we trained in section <a href="#id_6.%20Save%20trained%20prediction%20models%20with%20%60save_model()%60">6</a>,
we can predict cassava root dry matter content for our held out
validation set:</p>
<p>First, determine which pretreatment generated the best model and
pretreat the new spectral dataset accordingly.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the best pretreatment number from model stats</span></span>
<span><span class="va">best.pretreatment.name</span> <span class="op">&lt;-</span> <span class="va">model.to.save</span><span class="op">$</span><span class="va">best.model.stats</span><span class="op">$</span><span class="va">Pretreatment</span></span>
<span><span class="va">best.pretreatment.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">best.pretreatment.name</span>, </span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Raw_data"</span>, <span class="st">"SNV"</span>, <span class="st">"SNV1D"</span>, <span class="st">"SNV2D"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"SG"</span>,</span>
<span>                                 <span class="st">"SNVSG"</span>, <span class="st">"SGD1"</span>, <span class="st">"SG.D1W5"</span>, <span class="st">"SG.D1W11"</span>, <span class="st">"SG.D2W5"</span>, <span class="st">"SG.D2W11"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the example validation set (C16Mval)</span></span>
<span><span class="va">pretreated.val</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017.prepped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study.name</span> <span class="op">==</span> <span class="st">"C16Mval"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pretreat_spectra.html">pretreat_spectra</a></span><span class="op">(</span>pretreatment <span class="op">=</span> <span class="va">best.pretreatment.num</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pretreated.val.mx</span> <span class="op">&lt;-</span> <span class="va">pretreated.val</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">best.ncomp</span> <span class="op">&lt;-</span> <span class="va">model.to.save</span><span class="op">$</span><span class="va">best.model.stats</span><span class="op">$</span><span class="va">best.ncomp_mode</span></span></code></pre></div>
<div class="section level4">
<h4 id="perform-predictions">Perform predictions!<a class="anchor" aria-label="anchor" href="#perform-predictions"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted.values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model.to.save</span><span class="op">$</span><span class="va">best.model</span>,</span>
<span>                                       newdata <span class="op">=</span> <span class="va">pretreated.val.mx</span>,</span>
<span>                                       ncomp <span class="op">=</span> <span class="va">best.ncomp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="how-did-we-do">How did we do?<a class="anchor" aria-label="anchor" href="#how-did-we-do"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">spectacles</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spectacles/man/postResampleSpectro.html" class="external-link">postResampleSpectro</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="va">predicted.values</span>,</span>
<span>                                obs <span class="op">=</span> <span class="va">pretreated.val</span><span class="op">$</span><span class="va">reference</span><span class="op">)</span></span>
<span><span class="co">#&gt;      RMSE  Rsquared       RPD      RPIQ       CCC      Bias        SE </span></span>
<span><span class="co">#&gt; 1.5560069 0.8420531 2.4672707 2.7511960 0.9009541 0.1604845 1.5708972</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-predictions">Plot predictions<a class="anchor" aria-label="anchor" href="#plot-predictions"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">overall.range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pretreated.val</span><span class="op">$</span><span class="va">reference</span>, <span class="va">predicted.values</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pretreated.val</span><span class="op">$</span><span class="va">reference</span>, <span class="va">predicted.values</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>unique.id <span class="op">=</span> <span class="va">pretreated.val</span><span class="op">$</span><span class="va">unique.id</span>,</span>
<span>      observed <span class="op">=</span> <span class="va">pretreated.val</span><span class="op">$</span><span class="va">reference</span>,</span>
<span>      predicted <span class="op">=</span> <span class="va">predicted.values</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">observed</span><span class="op">)</span>,</span>
<span>         predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, y <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">overall.range</span>,</span>
<span>              ylim <span class="op">=</span> <span class="va">overall.range</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Example dry matter content predictions"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Observed"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="waves_files/figure-html/plot_predictions-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://jmh579.github.io" class="external-link">Jenna Hershberger</a>, NSF BREAD IOS-1543958.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
