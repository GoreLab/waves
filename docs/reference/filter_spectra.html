<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter spectral data frame based on Mahalanobis distance — filter_spectra • waves</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter spectral data frame based on Mahalanobis distance — filter_spectra"><meta property="og:description" content="Determine Mahalanobis distances of observations (rows) within a
  given data.frame with spectral data. Option to filter out
  observations based on these distances."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">waves</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/waves.html">Get Started</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GoreLab/waves/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter spectral data frame based on Mahalanobis distance</h1>
    <small class="dont-index">Source: <a href="https://github.com/GoreLab/waves/blob/HEAD/R/filter_spectra.R" class="external-link"><code>R/filter_spectra.R</code></a></small>
    <div class="hidden name"><code>filter_spectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Determine Mahalanobis distances of observations (rows) within a
  given <code>data.frame</code> with spectral data. Option to filter out
  observations based on these distances.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">filter_spectra</span><span class="op">(</span><span class="va">df</span>, <span class="va">filter</span>, <span class="va">return.distances</span>, <span class="va">num.col.before.spectra</span>,
  <span class="va">window.size</span>, <span class="va">verbose</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p><code>data.frame</code> object containing columns of spectra and rows of
observations. Spectral columns must be labeled with an "X" and then the
wavelength (example: "X740" = 740nm). Left-most column must be unique ID. May
also contain columns of metadata between the unique ID and spectral columns.
Cannot contain any missing values. Metadata column names may not start with "X".</p></dd>
<dt>filter</dt>
<dd><p>boolean that determines whether or not the input
<code>data.frame</code> will be filtered. If <code>TRUE</code>, <code>df</code> will be
filtered according to squared Mahalanobis distance with a 95% cutoff from
a chi-square distribution with degrees of freedom = number of spectral
columns. If <code>FALSE</code>, a column of squared Mahalanobis distances
<code>h.distance</code> will be added to the right side of df and all rows will
be returned. Default is <code>TRUE</code>.</p></dd>
<dt>return.distances</dt>
<dd><p>boolean that determines whether a column of squared
Mahalanobis distances will be included in output <code>data.frame</code>. If
<code>TRUE</code>, a column of Mahalanobis distances for each row will be added
to the right side of <code>df</code>. Default is <code>FALSE</code>.</p></dd>
<dt>num.col.before.spectra</dt>
<dd><p>number of columns to the left of the spectral
matrix in <code>df</code>. Default is 4.</p></dd>
<dt>window.size</dt>
<dd><p>number defining the size of window to use when calculating
the covariance of the spectra (required to calculate Mahalanobis distance).
Default is 10.</p></dd>
<dt>verbose</dt>
<dd><p>If <code>TRUE</code>, the number of rows removed through filtering
will be printed to the console. Default is <code>TRUE</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>filter</code> is <code>TRUE</code>, returns filtered data frame
<code>df</code> and reports the number of rows removed. The Mahalanobis distance
  with a cutoff of 95% of chi-square distribution (degrees of freedom =
  number of wavelengths) is used as filtering criteria. If <code>filter</code> is
<code>FALSE</code>, returns full input df with column <code>h.distances</code>  containing the Mahalanobis distance for each row.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function uses a chi-square distribution with 95% cutoff where
  degrees of freedom = number of wavelengths (columns) in the input
  <code>data.frame</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Johnson, R.A., and D.W. Wichern. 2007. Applied Multivariate
  Statistical Analysis (6th Edition). pg 189</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jenna Hershberger <a href="mailto:jmh579@cornell.edu">jmh579@cornell.edu</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">filtered.test</span> <span class="op">&lt;-</span> <span class="va">ikeogu.2017</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">TCC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">filter_spectra</span><span class="op">(</span></span>
<span class="r-in">    df <span class="op">=</span> <span class="va">.</span>,</span>
<span class="r-in">    filter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">    return.distances <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">    num.col.before.spectra <span class="op">=</span> <span class="fl">5</span>,</span>
<span class="r-in">    window.size <span class="op">=</span> <span class="fl">15</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Removed 0 rows.</span>
<span class="r-in"><span class="va">filtered.test</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">filtered.test</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">filtered.test</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   study.name sample.id DMC.oven      X350      X351    X2496    X2497    X2498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    C16Mcal C16Mcal_1 39.62109 0.4881079 0.4951843 1.868554 1.866739 1.867465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    C16Mcal C16Mcal_2 35.52017 0.5727389 0.5682541 1.891462 1.893840 1.901451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    C16Mcal C16Mcal_3 42.04462 0.5989934 0.6266454 1.832336 1.834644 1.828793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    C16Mcal C16Mcal_4 39.00999 0.5169374 0.5164186 1.839129 1.837023 1.836635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    C16Mcal C16Mcal_5 33.44273 0.5189608 0.5477946 1.899751 1.900873 1.897076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      X2499    X2500 h.distances</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.870405 1.870702    139.8898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.891114 1.888507    149.5721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.826562 1.832022    140.5149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.835856 1.834857    148.3881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.899430 1.896130    152.2514</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://jmh579.github.io" class="external-link">Jenna Hershberger</a>, NSF BREAD IOS-1543958.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

