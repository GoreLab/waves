<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Format multiple trials with or without overlapping genotypes into
  training and test sets according to user-provided cross validation scheme — format_cv • waves</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/solar/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Format multiple trials with or without overlapping genotypes into
  training and test sets according to user-provided cross validation scheme — format_cv" />
<meta property="og:description" content="Standalone function that is also used within
  train_spectra to divide trials or studies into training and test
  sets based on overlap in trial environments and genotype entries" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">waves</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GoreLab/waves/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Format multiple trials with or without overlapping genotypes into
  training and test sets according to user-provided cross validation scheme</h1>
    <small class="dont-index">Source: <a href='https://github.com/GoreLab/waves/blob/master/R/format_cv.R'><code>R/format_cv.R</code></a></small>
    <div class="hidden name"><code>format_cv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Standalone function that is also used within
  <code><a href='train_spectra.html'>train_spectra</a></code> to divide trials or studies into training and test
  sets based on overlap in trial environments and genotype entries</p>
    </div>

    <pre class="usage"><span class='fu'>format_cv</span><span class='op'>(</span>
  <span class='va'>trial1</span>,
  <span class='va'>trial2</span>,
  trial3 <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>cv.scheme</span>,
  cv.method <span class='op'>=</span> <span class='st'>"stratified"</span>,
  proportion.train <span class='op'>=</span> <span class='fl'>0.7</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  remove.genotype <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>trial1</th>
      <td><p><code>data.frame</code> object that is for use only when
<code>cv.scheme</code> is provided. Contains the trial to be tested in subsequent
model training functions. The first column contains unique identifiers,
second contains genotypes, third contains reference values, followed by
spectral columns. Include no other columns to right of spectra! Column
names of spectra must start with "X", reference column must be named
"reference", and genotype column must be named "genotype".</p></td>
    </tr>
    <tr>
      <th>trial2</th>
      <td><p><code>data.frame</code> object that is for use only when
<code>cv.scheme</code> is provided. This data.frame contains a trial that has
overlapping genotypes with <code>trial1</code> but that were grown in a different
site/year (different environment). Formatting must be consistent with
<code>trial1</code>.</p></td>
    </tr>
    <tr>
      <th>trial3</th>
      <td><p><code>data.frame</code> object that is for use only when
<code>cv.scheme</code> is provided. This data.frame contains a trial that may or
may not contain genotypes that overlap with <code>trial1</code>. Formatting must
be consistent with <code>trial1</code>.</p></td>
    </tr>
    <tr>
      <th>cv.scheme</th>
      <td><p>A cross validation (CV) scheme from Jarquín et al., 2017.
Options for <code>cv.scheme</code> include:</p><ul>
<li><p>"CV1": untested lines in tested environments</p></li>
<li><p>"CV2": tested lines in tested environments</p></li>
<li><p>"CV0": tested lines in untested environments</p></li>
<li><p>"CV00": untested lines in untested environments</p></li>
</ul></td>
    </tr>
    <tr>
      <th>cv.method</th>
      <td><p>Cross-validation method used to subdivide into training
and test sets. Options for <code>cv.method</code> include:</p><ul>
<li><p>"random": random cross-validation with 70<!-- % training and 30% test --></p></li>
<li><p>"stratified": random cross-validation stratified by reference
    values. 70<!-- % training and 30% test. --></p></li>
</ul><p>Default is <code>stratified</code>.</p></td>
    </tr>
    <tr>
      <th>proportion.train</th>
      <td><p>Fraction of samples to include in the training set.
Default is 0.7.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Number used in the function <code><a href='https://rdrr.io/r/base/Random.html'>set.seed()</a></code> for reproducible
randomization. If <code>NULL</code>, no seed is set. Default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>remove.genotype</th>
      <td><p>boolean that, if <code>TRUE</code>, removes the "genotype"
column is removed from the output <code>data.frame</code>. Default is
<code>FALSE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of data.frames ($train.set, $test.set) compiled according to
  user-provided cross validation scheme.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Use of a cross-validation scheme requires a column in the input
  <code>data.frame</code> named "genotype" to ensure proper sorting of training and
  test sets. Variables <code>trial1</code> and <code>trial2</code> are required, while
  <code>trial 3</code> is optional.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jarquín, D., C. Lemes da Silva, R. C. Gaynor, J. Poland, A.
  Fritz, R. Howard, S. Battenfield, and J. Crossa. 2017. Increasing
  genomic-enabled prediction accuracy by modeling genotype × environment
  interactions in Kansas wheat. Plant Genome 10(2):1-15.
  &lt;doi:10.3835/plantgenome2016.12.0130&gt;</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jenna Hershberger <a href='mailto:jmh579@cornell.edu'>jmh579@cornell.edu</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Must have a column called "genotype", so we'll create a fake one for now</span>
<span class='co'># We will use CV00, which does not require any overlap in genotypes</span>
<span class='co'># In real scenarios, CV schemes that rely on genotypes should not be applied when</span>
<span class='co'># genotypes are unknown, as in this case.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
<span class='va'>trials</span> <span class='op'>&lt;-</span> <span class='va'>ikeogu.2017</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>genotype <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>ikeogu.2017</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># fake for this example</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>reference <span class='op'>=</span> <span class='va'>DMC.oven</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>
    <span class='va'>study.name</span>, <span class='va'>sample.id</span>, <span class='va'>genotype</span>, <span class='va'>reference</span>,
    <span class='fu'>tidyselect</span><span class='fu'>::</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"X"</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>trial1</span> <span class='op'>&lt;-</span> <span class='va'>trials</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>study.name</span> <span class='op'>==</span> <span class='st'>"C16Mcal"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>study.name</span><span class='op'>)</span>
<span class='va'>trial2</span> <span class='op'>&lt;-</span> <span class='va'>trials</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>study.name</span> <span class='op'>==</span> <span class='st'>"C16Mval"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>study.name</span><span class='op'>)</span>
<span class='va'>cv.list</span> <span class='op'>&lt;-</span> <span class='fu'>format_cv</span><span class='op'>(</span>
  trial1 <span class='op'>=</span> <span class='va'>trial1</span>, trial2 <span class='op'>=</span> <span class='va'>trial2</span>, cv.scheme <span class='op'>=</span> <span class='st'>"CV00"</span>,
  cv.method <span class='op'>=</span> <span class='st'>"random"</span>, remove.genotype <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
<span class='va'>cv.list</span><span class='op'>$</span><span class='va'>train.set</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 5 x 5</span>
#&gt;   sample.id reference  X350  X351  X352
#&gt;   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span> C16Mval_1      44.1 0.497 0.474 0.489
#&gt; <span style='color: #BCBCBC;'>2</span> C16Mval_2      43.7 0.546 0.556 0.557
#&gt; <span style='color: #BCBCBC;'>3</span> C16Mval_3      43.4 0.513 0.521 0.529
#&gt; <span style='color: #BCBCBC;'>4</span> C16Mval_4      43.1 0.565 0.570 0.583
#&gt; <span style='color: #BCBCBC;'>5</span> C16Mval_5      41.8 0.497 0.502 0.510</div><div class='input'><span class='va'>cv.list</span><span class='op'>$</span><span class='va'>test.set</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 5 x 5</span>
#&gt;   sample.id  reference  X350  X351  X352
#&gt;   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>          <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span> C16Mcal_6       32.1 0.576 0.566 0.589
#&gt; <span style='color: #BCBCBC;'>2</span> C16Mcal_9       38.1 0.675 0.662 0.688
#&gt; <span style='color: #BCBCBC;'>3</span> C16Mcal_16      36.4 0.517 0.514 0.530
#&gt; <span style='color: #BCBCBC;'>4</span> C16Mcal_24      42.2 0.484 0.490 0.483
#&gt; <span style='color: #BCBCBC;'>5</span> C16Mcal_26      28.5 0.620 0.617 0.630</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jmh579.github.io'>Jenna Hershberger</a>, NSF BREAD IOS-1543958.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


